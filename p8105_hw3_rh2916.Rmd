---
title: "p8105_hw3_rh2916"
author: "Rui Huang"
date: "October 6, 2018"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
library(skimr)
library(dplyr)
library(ggridges)
library(patchwork)
library(lubridate)
library(hexbin)
```

## Problem 1
```{r}
library(p8105.datasets)
data(brfss_smart2010)
```

```{r}
problem1_data =
  brfss_smart2010 %>%
  janitor::clean_names() %>%
  filter(topic == "Overall Health" ) %>%
  mutate(response = as.factor(response)) %>%
  select(-class, -topic, -question, -sample_size, -(confidence_limit_low : geo_location))
```

### In 2002, which states were observed at 7 locations?

```{r}
problem1_data %>%
  filter(year == 2002) %>%
  group_by(locationabbr) %>%
  summarize(n_locationdesc = n_distinct(locationdesc)) %>%
  filter(n_locationdesc == 7)
```


Based on the result, CT, FL and NC were observed at 7 locations in 2002.

### Make a “spaghetti plot” that shows the number of observations in each state from 2002 to 2010.

```{r}
problem1_data %>%
  group_by(year, locationabbr) %>%
  summarize(n_obs = n()) %>%
  ggplot(aes(x = year, y = n_obs, color = locationabbr)) +
  geom_line() +
  labs(
    title = "Spaghetti plot for number of observations in each state",
    x = "Year",
    y = "Number of observations",
    caption = "Data from the rnoaa package"
  ) 
```

Based on the result, we can find that the fluctuation for observations increases by year. And the maximum observation number is about 220, which occurs in 2007. The majority of observation numbers are under 100. However, it is difficult to tell the observaion differences between different states by the spaghetti plot.
